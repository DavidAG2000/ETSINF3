(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15420,        392]
NotebookOptionsPosition[     14949,        371]
NotebookOutlinePosition[     15292,        386]
CellTagsIndexPosition[     15249,        383]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"NotebookSave", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CYK", "[", 
    RowBox[{"grammar_", ",", "word_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "operations", ",", "antecedent", ",", "consequent", ",", "lword", ",", 
       "n", ",", "k", ",", "matrix", ",", "i", ",", "j", ",", "partB", ",", 
       "partC", ",", "combinations", ",", "e", ",", "f", ",", "initial"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lword", " ", "=", " ", 
       RowBox[{"Length", "[", "word", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"matrix", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"operations", " ", "=", " ", 
       RowBox[{"grammar", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"initial", " ", "=", " ", 
       RowBox[{"grammar", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "lword"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"n", "=", "1"}], ",", 
           RowBox[{"n", "\[LessEqual]", " ", 
            RowBox[{"Length", "[", "operations", "]"}]}], ",", 
           RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"antecedent", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"operations", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"consequent", " ", "=", " ", 
             RowBox[{
              RowBox[{"operations", "[", 
               RowBox[{"[", "n", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"k", "=", "1"}], ",", 
              RowBox[{"k", "\[LessEqual]", 
               RowBox[{"Length", "[", "consequent", "]"}]}], ",", " ", 
              RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"consequent", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                  RowBox[{"word", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"AppendTo", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"matrix", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "antecedent"}], 
                   "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "2"}], ",", 
        RowBox[{"j", "\[LessEqual]", "lword"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"matrix", ",", 
           RowBox[{"{", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"lword", "-", "j", "+", "1"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{"matrix", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"{", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"combinations", " ", "=", " ", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"k", "=", "1"}], ",", 
              RowBox[{"k", "\[LessEqual]", 
               RowBox[{"j", "-", "1"}]}], ",", 
              RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"partB", " ", "=", " ", 
                RowBox[{
                 RowBox[{"matrix", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"partC", " ", "=", " ", 
                RowBox[{
                 RowBox[{"matrix", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", "-", "k"}], "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "k"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"e", " ", "=", "1"}], ",", 
                 RowBox[{"e", "\[LessEqual]", " ", 
                  RowBox[{"Length", "[", "partB", "]"}]}], ",", 
                 RowBox[{"e", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"f", "=", "1"}], ",", 
                    RowBox[{"f", "\[LessEqual]", 
                    RowBox[{"Length", "[", "partC", "]"}]}], ",", 
                    RowBox[{"f", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"combinations", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"partB", "[", 
                    RowBox[{"[", "e", "]"}], "]"}], ",", 
                    RowBox[{"partC", "[", 
                    RowBox[{"[", "f", "]"}], "]"}]}], "}"}]}], "]"}], ";"}]}],
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"n", "=", "1"}], ",", 
              RowBox[{"n", "\[LessEqual]", " ", 
               RowBox[{"Length", "[", "operations", "]"}]}], ",", 
              RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"antecedent", " ", "=", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"operations", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"consequent", " ", "=", " ", 
                RowBox[{
                 RowBox[{"operations", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"k", "=", "1"}], ",", 
                 RowBox[{"k", "\[LessEqual]", 
                  RowBox[{"Length", "[", "consequent", "]"}]}], ",", " ", 
                 RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"combinations", ",", 
                    RowBox[{"consequent", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"matrix", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "antecedent"}], 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"matrix", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"Union", "[", 
              RowBox[{
               RowBox[{"matrix", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "lword", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "initial"}], "]"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.65700662366917*^9, 3.6570068856974897`*^9}, {
   3.65700692466015*^9, 3.6570069773157663`*^9}, {3.657007082920332*^9, 
   3.657007086984805*^9}, {3.6965988946478944`*^9, 3.696598926261893*^9}, {
   3.6965990038183136`*^9, 3.696599049289988*^9}, {3.696599097906272*^9, 
   3.6965991569300632`*^9}, {3.6965991993625164`*^9, 
   3.6965992148761773`*^9}, {3.6965992496085863`*^9, 
   3.6965993076770773`*^9}, {3.6965994865536003`*^9, 
   3.6965995379350915`*^9}, {3.6965997255738215`*^9, 
   3.6965997363243012`*^9}, {3.696599772423813*^9, 3.6965998354036713`*^9}, {
   3.6965999577459965`*^9, 3.6965999926482897`*^9}, {3.6966010360264654`*^9, 
   3.6966011007800603`*^9}, {3.696601134804897*^9, 3.6966011750586433`*^9}, 
   3.6966012072263966`*^9, {3.6966012376492434`*^9, 3.696601326371602*^9}, {
   3.696601500805561*^9, 3.6966015034207115`*^9}, {3.6967001747464185`*^9, 
   3.6967001752246118`*^9}, {3.698400412500822*^9, 3.6984005065091352`*^9}, {
   3.6984005993469477`*^9, 3.698400623471731*^9}, {3.698400682859606*^9, 
   3.6984007487589903`*^9}, {3.6984007865267134`*^9, 3.698400903257148*^9}, 
   3.6984011294390697`*^9, {3.6984012654537125`*^9, 3.6984017144041543`*^9}, {
   3.698401754593751*^9, 3.698401755219581*^9}, {3.6984017909739237`*^9, 
   3.6984019343395553`*^9}, {3.698401974049954*^9, 3.6984019762878494`*^9}, {
   3.6984020101676025`*^9, 3.698402085086051*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"scheme", " ", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S", ",", "A", ",", "B", ",", "C"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "S", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", "B"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"B", ",", "C"}], "}"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "A", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"B", ",", "A"}], "}"}], ",", 
          RowBox[{"{", "a", "}"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "B", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"C", ",", "C"}], "}"}], ",", 
          RowBox[{"{", "b", "}"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "C", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", "B"}], "}"}], ",", 
          RowBox[{"{", "a", "}"}]}], "}"}]}], "}"}]}], "}"}], ",", "S"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.6967026244932013`*^9, 3.6967026737371187`*^9}, {
  3.696702872722331*^9, 3.6967028728340993`*^9}, {3.698353396686223*^9, 
  3.6983533967655897`*^9}, {3.6983541492761726`*^9, 3.698354149678933*^9}, {
  3.698400924713375*^9, 3.6984009979196825`*^9}, {3.698402104851424*^9, 
  3.698402115348249*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"S", ",", "A", ",", "B", ",", "C"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "S", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", "B"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"B", ",", "C"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "A", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"B", ",", "A"}], "}"}], ",", 
         RowBox[{"{", "a", "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "B", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"C", ",", "C"}], "}"}], ",", 
         RowBox[{"{", "b", "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "C", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", "B"}], "}"}], ",", 
         RowBox[{"{", "a", "}"}]}], "}"}]}], "}"}]}], "}"}], ",", "S"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.69840100056915*^9, 3.698401031320176*^9, {3.6984021097564316`*^9, 
   3.6984021203867292`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CYK", "[", 
  RowBox[{"scheme", ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "a", ",", "a", ",", "b", ",", "a"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.698401003708083*^9, 3.69840102372293*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.698401942096485*^9, {3.6984020943814497`*^9, 3.6984021222754607`*^9}}]
}, Open  ]]
},
WindowSize->{958, 988},
WindowMargins->{{-967, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 10977, 234, 905, "Input"],
Cell[CellGroupData[{
Cell[11560, 258, 1623, 48, 50, "Input"],
Cell[13186, 308, 1350, 45, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14573, 358, 231, 6, 30, "Input"],
Cell[14807, 366, 126, 2, 30, "Output"]
}, Open  ]]
}
]
*)

